# üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ª–∞–π–∫–æ–≤

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ª–∞–π–∫–æ–≤ –≤ Supabase

**–í–ê–ñ–ù–û**: –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `likes` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –µ—ë:

```sql
-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
DROP TABLE IF EXISTS likes CASCADE;
```

–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –∏–∑ —Ñ–∞–π–ª–∞ `docs/database_likes_table.sql` –≤ SQL Editor –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ Supabase:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `docs/database_likes_table.sql`

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
SELECT table_name 
FROM information_schema.tables 
WHERE table_name = 'likes';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã
SELECT column_name, data_type, is_nullable 
FROM information_schema.columns 
WHERE table_name = 'likes';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤
SELECT indexname, indexdef 
FROM pg_indexes 
WHERE tablename = 'likes';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π
SELECT 
    tc.table_name, 
    kcu.column_name, 
    ccu.table_name AS foreign_table_name,
    ccu.column_name AS foreign_column_name 
FROM 
    information_schema.table_constraints AS tc 
    JOIN information_schema.key_column_usage AS kcu
      ON tc.constraint_name = kcu.constraint_name
      AND tc.table_schema = kcu.table_schema
    JOIN information_schema.constraint_column_usage AS ccu
      ON ccu.constraint_name = tc.constraint_name
      AND ccu.table_schema = tc.table_schema
WHERE tc.constraint_type = 'FOREIGN KEY' AND tc.table_name='likes';
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API endpoints:

#### –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫:
```bash
curl -X POST http://localhost:3000/api/likes \
  -H "Content-Type: application/json" \
  -d '{
    "post_id": "uuid-–ø–æ—Å—Ç–∞",
    "post_type": "promise",
    "user_id": 123456789
  }'
```

#### –£–±—Ä–∞—Ç—å –ª–∞–π–∫:
```bash
curl -X DELETE http://localhost:3000/api/likes \
  -H "Content-Type: application/json" \
  -d '{
    "post_id": "uuid-–ø–æ—Å—Ç–∞",
    "post_type": "promise",
    "user_id": 123456789
  }'
```

#### –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∞–π–∫–∞—Ö:
```bash
curl "http://localhost:3000/api/likes?post_id=uuid-–ø–æ—Å—Ç–∞&post_type=promise&user_id=123456789"
```

## üîß –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- ‚úÖ `LikeButton.tsx` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏ –ª–∞–π–∫–∞
- ‚úÖ `useLikes.ts` - —Ö—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–∞–π–∫–∞–º–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `PromiseView.tsx`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `ChallengeView.tsx`

### API endpoints:
- ‚úÖ `GET /api/likes` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–∞–π–∫–∞—Ö
- ‚úÖ `POST /api/likes` - –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞)
- ‚úÖ `DELETE /api/likes` - —É–±—Ä–∞—Ç—å –ª–∞–π–∫

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ `LikeData` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ª–∞–π–∫–∞
- ‚úÖ `PostLikeData` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ –ª–∞–π–∫–∞—Ö –ø–æ—Å—Ç–∞
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã `PostData`, `PromiseData`, `ChallengeData`

## üöÄ Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Supabase subscriptions:
- –õ–∞–π–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `likes` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞

## üì± –ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- ‚úÖ `/list` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
- ‚úÖ `/user/[telegramId]` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `/profile/[telegramId]` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ü–æ—Å–∫–æ–ª—å–∫—É –≤ –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- RLS –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `likes`
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ API endpoints
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ª–∞–π–∫–∞

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–û—à–∏–±–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `user_id` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
2. **–ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω**: API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ª–∞–π–∫–∞
3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∞–π–∫–æ–≤**: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ª–∞–π–∫–∏
4. **Real-time –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ real-time

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –õ–∞–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –°—á–µ—Ç—á–∏–∫–∏ –ª–∞–π–∫–æ–≤ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ª–∞–π–∫–Ω—É—Ç–æ/–Ω–µ –ª–∞–π–∫–Ω—É—Ç–æ)
- API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ª–∞–π–∫–∞
- –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –Ω–∞ –ø–æ—Å—Ç—ã —É–±—Ä–∞–Ω—ã –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ 